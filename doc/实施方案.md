# 绩效指标体系电子系统实施方案

## 一、项目概述

### 1.1 项目背景

山东某公司石油化工有限公司（以下简称"甲方"）拟建设基于过程安全理念的安全绩效指标体系电子系统（二期），继续深化和扩展一期项目成果，实现企业安全管理的数字化、精细化和科学化。南京工业大学（以下简称"乙方"）受甲方委托，负责该系统的设计、开发与实施。

### 1.2 项目目标

1. 建立符合CCPS标准的安全绩效指标数据库和管理系统
2. 实现数据自动采集、指标自动计算和报表自动生成
3. 支持事故全流程管理（报告、分级、调查、整改、追踪）
4. 构建安全管理持续改进机制
5. 实现与企业现有信息系统的无缝对接

### 1.3 实施范围

1. 绩效指标体系电子系统的设计与开发
2. 系统部署、测试与上线
3. 用户培训与系统运维支持
4. 系统指标调整与优化服务

## 二、技术架构方案

### 2.1 总体架构

本系统采用前后端分离架构，基于Vue 3、TypeScript、Supabase、Pinia和VueUse技术栈开发，采用B/S架构模式，实现跨平台、易扩展的系统设计。

#### 2.1.1 系统架构图

```
+----------------------------------+
|            用户层               |
|            (浏览器)             |
+----------------------------------+
               ↑↓
+----------------------------------+
|            应用层               |
|                                 |
|  +------------+  +------------+ |
|  | 指标管理模块 |  | 事故管理模块 | |
|  +------------+  +------------+ |
|                                 |
|  +------------+  +------------+ |
|  | 报表分析模块 |  | 系统管理模块 | |
|  +------------+  +------------+ |
+----------------------------------+
               ↑↓
+----------------------------------+
|            服务层               |
|                                 |
|  +------------+  +------------+ |
|  | 数据采集服务 |  | 数据计算服务 | |
|  +------------+  +------------+ |
|                                 |
|  +------------+  +------------+ |
|  | 通知服务    |  | 集成服务    | |
|  +------------+  +------------+ |
+----------------------------------+
               ↑↓
+----------------------------------+
|            数据层               |
|                                 |
|  +------------+  +------------+ |
|  | 指标数据库  |  | 事故数据库  | |
|  +------------+  +------------+ |
|                                 |
|  +------------+                |
|  | 配置数据库  |                |
|  +------------+                |
+----------------------------------+
               ↑↓
+----------------------------------+
|           外部系统              |
|                                 |
|  +------------+  +------------+ |
|  |  HR系统    |  | 其他业务系统 | |
|  +------------+  +------------+ |
+----------------------------------+
```

### 2.2 技术选型

1. **前端技术**：
   - Vue 3 (框架)：采用Composition API模式开发，提高代码复用性和可维护性
   - TypeScript (类型安全)：全面应用类型系统，尤其是Supabase数据模型的类型定义
   - Pinia (状态管理)：利用其模块化特性管理指标、事故、用户认证等状态
   - VueUse (工具库)：应用其响应式API、网络请求封装、状态持久化等功能
   - ElementPlus (UI组件)：构建符合企业应用风格的界面
   - ECharts (数据可视化)：实现指标趋势、事故统计等多维度可视化展示

2. **后端技术**：
   - Supabase (BaaS平台)：核心后端服务，提供数据存储、认证、实时订阅等功能
   - PostgreSQL (数据库)：通过Supabase提供的PostgreSQL服务进行数据存储
   - RESTful API (接口规范)：用于与外部系统集成的接口设计标准
   - Node.js (中间件)：用于开发自定义API和集成适配器

3. **部署环境**：
   - Docker容器：将应用封装为容器便于部署和迁移（待确认是否可行）
   - Nginx (Web服务器)：用于静态资源托管和API代理
   - Linux/Windows Server (操作系统)：根据甲方IT环境确定

### 2.3 Supabase集成详细方案

#### 2.3.1 Supabase核心服务使用规划

1. **数据库服务**
   - 利用PostgreSQL强大的表关系和约束功能设计数据模型
   - 应用RLS(行级安全)策略实现细粒度的数据访问控制
   - 设计PostgreSQL触发器和函数实现业务逻辑的数据库级执行
   - 利用PostgreSQL的JSON/JSONB类型存储非结构化或半结构化数据

2. **认证服务**
   - 基于JWT的用户认证与会话管理
   - 与甲方现有身份验证系统集成
   - 多因素认证方案（需确认是否需要）
   - 基于角色的访问控制实现

3. **实时订阅**
   - 利用Supabase实时订阅功能监听数据变化
   - 实现指标数据实时更新
   - 事故报告实时通知和协作
   - 操作日志实时记录和监控

4. **存储服务**
   - 用于事故相关文档和图片的上传和管理
   - 文件权限控制与生命周期管理


5. **Edge Functions**
   - 开发定制化的服务端函数处理复杂业务逻辑
   - 实现与外部系统的集成适配器
   - 处理定时任务和批量操作

#### 2.3.2 Supabase安全策略

1. **数据安全**
   - 设计行级安全(RLS)策略，确保用户只能访问其权限范围内的数据
   - 实现数据加密存储方案，特别是敏感个人信息
   - 设计数据备份和恢复策略

2. **API安全**
   - API请求认证与授权控制
   - 防止SQL注入和其他常见Web攻击
   - API请求速率限制和监控

3. **客户端安全**
   - 敏感数据客户端加密
   - 前端权限控制与UI适配

### 2.4 数据库设计详细方案

#### 2.4.1 核心数据模型概述

系统将设计以下核心数据模型，并需与甲方确认具体字段和关系：（暂定）


1. **组织架构模型**
   - 部门表(departments)：存储公司组织架构
   - 职位表(positions)：定义职位及其层级关系


2. **用户权限模型**
   - 用户表(users)：系统用户信息，与Supabase Auth关联
   - 角色表(roles)：定义系统角色类型
   - 权限表(permissions)：细粒度权限定义
   - 角色权限映射表(role_permissions)：权限分配关系
   - 用户角色映射表(user_roles)：用户与角色的多对多关系

3. **指标体系模型**
   - 指标类别表(indicator_categories)：CCPS标准指标分类
   - 指标定义表(indicators)：指标基本定义和属性
   - 指标计算公式表(calculation_formulas)：可配置的计算逻辑
   - 指标值表(indicator_values)：记录指标的时间序列数据
   - 指标阈值表(thresholds)：定义指标预警和等级划分阈值
   - 指标变更历史表(indicator_changes)：记录指标定义和计算方法的变更

4. **事故管理模型**
   - 事故表(accidents)：记录事故基本信息
   - 事故分类表(accident_types)：CCPS事故分类标准
   - 事故调查表(investigations)：调查过程和结果
   - 整改措施表(corrective_actions)：整改计划和执行
   - 事故附件表(accident_attachments)：关联文档和图片
   - 事故审批流程表(approval_flows)：定义审批流程和状态

5. **配置管理模型**
   - 系统参数表(system_parameters)：全局配置项
   - 通知模板表(notification_templates)：邮件等通知的模板
   - 报表模板表(report_templates)：预定义和自定义报表模板
   - UI配置表(ui_configurations)：界面个性化设置


#### 2.4.2 与甲方需确认的数据库设计要点

1. **数据规模与性能需求**
   - 预估数据量：用户数、部门数、指标数、每日事故记录数等
   - 历史数据保留策略：数据归档和清理规则

2. **数据源映射关系**
   - HR系统数据结构与本系统人员表的映射关系
   - 外部系统指标数据格式与系统指标表的转换规则
   - 一期项目数据结构与二期系统的兼容性分析

3. **数据安全与合规要求**
   - 敏感数据字段识别和处理方案
   - 数据访问审计要求
   - 数据备份和恢复策略

## 三、功能模块设计

### 3.1 指标管理模块（暂定）

1. **指标定义与维护**
   - 指标基本信息维护：名称、编码、分类、描述、单位等
   - 指标关联关系管理：上下级指标、关联指标
   - 指标版本控制：变更历史记录和追溯
   - 指标状态管理：启用/禁用/测试

2. **指标数据采集**
   - 自动采集配置：数据源、采集周期、映射规则
   - 手动填报界面：单条录入、批量导入
   - 数据验证规则：取值范围、逻辑检查
   - 采集日志与异常处理：记录并通知数据异常

3. **指标计算与展示**
   - 计算公式维护：支持自定义函数和复杂逻辑
   - 计算依赖分析：识别并处理指标间依赖关系
   - 计算过程追溯：记录计算中间结果和数据来源
   - 多维度展示：按时间、部门、类别等多维度查看

4. **指标阈值设置与告警**
   - 多级阈值设置：优/良/中/差多级划分
   - 动态阈值规则：基于历史数据的自适应阈值
   - 告警规则配置：触发条件、通知对象、通知方式
   - 告警状态管理：确认、处理、关闭

5. **指标变更管理**
   - 变更申请与审批流程
   - 变更影响分析：识别关联指标和影响范围
   - 变更执行与验证：确保变更后数据一致性
   - 变更历史记录：完整保留变更前后对比

### 3.2 事故管理模块（暂定）

1. **事故报告填报**
   - 快速报告界面：支持移动端快速上报
   - 分步填报流程：基本信息、详细信息、原因分析、整改措施
   - 模板化填报：根据事故类型自动加载填报模板
   - 草稿保存与继续填报

2. **事故分级与分类**
   - 基于CCPS标准的事故分类体系
   - 严重程度分级标准与评估流程
   - 自动分级建议：基于填报信息提供分级建议
   - 分级审核与确认流程

3. **事故调查管理**
   - 调查小组组建与任务分配
   - 调查过程记录：现场调查、人员访谈、证据收集
   - 调查报告生成：基于调查结果自动生成报告
   - 调查结论与教训总结

4. **整改措施跟踪**
   - 整改措施制定：责任人、截止日期、预期效果
   - 整改实施过程记录：进度更新、中间检查
   - 整改效果验证：完成证据上传、效果评估
   - 整改状态监控与逾期提醒

5. **事故统计分析**
   - 多维度统计：时间、类型、部门、原因等
   - 趋势分析：环比、同比变化
   - 关联性分析：识别常见原因和高风险区域
   - 案例库建设：典型事故案例收集与检索

### 3.3 报表分析模块（暂定）

1. **预设报表生成**
   - 日/周/月/季/年度安全绩效报表
   - 部门/车间/班组级别绩效对比报表
   - 事故分析报表：分布、趋势、原因分析
   - 管理层决策支持报表：关键指标综合分析


2. **数据可视化展示**
   - 多种图表类型：基础图表、复合图表、特殊图表
   - 实时数据更新：关键指标实时刷新


3. **报表导出功能**
   - 多格式导出：Excel、PDF、Word等
   - 批量导出功能：多报表一键生成



### 3.4 系统管理模块

1. **用户与角色管理**
   - 用户信息管理：基本信息、账号状态
   - 角色定义与维护：预设角色和自定义角色
   - 用户-角色分配：多角色支持和继承关系
   - 登录安全策略：密码规则、多因素认证、登录控制

2. **权限配置管理**
   - 功能权限设置：模块、页面、按钮级别控制
   - 数据权限设置：行级、字段级数据访问控制
   - 审批权限设置：不同类型事务的审批链配置
   - 权限效果预览：权限设置可视化验证

3. **系统参数设置**
   - 业务参数配置：默认值、阈值、规则等
   - 通知设置：邮件服务器、消息模板
   - 第三方集成配置：API密钥、接口地址等

4. **系统日志管理**（supabase 控台台）
   - 操作日志记录：用户操作轨迹完整保存
   - 系统日志监控：错误、警告、信息级别日志

5. **数据备份与恢复**
   - 自动备份策略：定时全量/增量备份
   - 手动备份功能：重要操作前手动备份
   - 数据恢复流程：选择备份点和恢复范围
   - 数据迁移工具：历史数据导入导出

## 四、集成方案

### 4.1 HR系统集成

#### 4.1.1 集成架构

设计与HR系统的集成接口，用于获取组织架构、人员信息等数据。我们将采用以下集成架构：

```
+----------------+        +---------------+        +------------------+
|                |  API/  |               |        |                  |
|   HR系统      | <-----> | 集成适配器    | <-----> | 安全绩效系统     |
|                |  文件   |               |        |                  |
+----------------+        +---------------+        +------------------+
```

#### 4.1.2 数据同步策略

1. **初始数据同步**
   - 全量加载组织架构和人员基础数据
   - 建立唯一标识符映射关系
   - 数据一致性验证和冲突处理

2. **增量数据同步**
   - 定时轮询变更数据（如有API支持）
   - 消息队列方式（如有事件通知）

3. **数据转换与加载**
   - 字段映射规则配置
   - 数据格式转换处理
   - 数据验证和异常处理

4. **同步监控与管理**
   - 同步任务调度和监控
   - 同步日志记录和分析
   - 失败重试和告警机制

*注：需甲方提供HR系统接口文档，包括API规格、认证方式、数据格式等*

### 4.2 其他系统集成

根据甲方需求，设计与其他业务系统的数据集成方案。

*注：需甲方提供相关系统清单及接口文档*

### 4.3 外挂源模型计算工具集成

#### 4.3.1 集成需求分析

设计与外挂源模型计算工具的集成方案，用于支持特定指标的计算。该工具可能涉及复杂的工程计算模型，需要专门的集成方案。

#### 4.3.2 集成方式选择

根据工具特性，可选择以下集成方式：

1. **命令行调用**：通过子进程方式调用外部工具
2. **API封装**：将工具包装为微服务或API
3. **库引用**：直接引用计算库（如支持）
4. **脚本集成**：通过脚本语言桥接

#### 4.3.3 数据交换格式

1. **输入格式**：定义结构化输入数据格式（JSON/XML/CSV）
2. **输出格式**：定义结构化输出结果格式
3. **参数映射**：建立系统参数与模型参数的映射关系

#### 4.3.4 集成架构设计

```
+------------------+     +-----------------+     +------------------+
|                  |     |                 |     |                  |
| 安全绩效系统     | --> | 适配器/转换层   | --> | 源模型计算工具   |
|                  |     |                 |     |                  |
+------------------+     +-----------------+     +------------------+
        ^                                               |
        |                                               |
        +-----------------------------------------------+
                           结果返回
```

*注：需甲方提供工具技术规格及接口文档*

### 4.4 数据同步与实时更新机制

#### 4.4.1 数据同步策略（待确认）

1. **定时同步**：按照配置的时间间隔进行同步
2. **触发同步**：基于特定事件触发的同步
3. **手动同步**：允许管理员手动启动同步
4. **增量同步**：仅同步变更数据
5. **全量同步**：完整重建数据

#### 4.4.2 实时数据更新机制

利用Supabase的实时功能实现关键数据的实时更新：

1. **实时数据订阅**：前端订阅关键数据变更
2. **推送通知**：数据变更时向相关用户推送通知
3. **实时协作**：支持多用户同时编辑和查看
4. **状态同步**：确保所有客户端状态一致


## 五、项目管理计划

### 5.1 项目组织架构

```
项目指导委员会
    ↓
项目经理（乙方）← → 项目经理（甲方）
    ↓
+-------------+-------------+-------------+
|             |             |             |
系统架构师    开发团队      测试团队     实施团队
```

### 5.2 人员配置

1. 项目经理：负责整体项目管理和协调
2. 系统架构师：负责系统架构设计
3. 前端开发工程师：负责前端界面开发
4. 后端开发工程师：负责后端服务开发
5. 数据库工程师：负责数据库设计与优化
6. 测试工程师：负责系统测试
7. 实施工程师：负责系统部署与培训

### 5.3 进度计划

根据合同2.14项目进度安排（以合同签订日为起点）：

1. 前期准备（项目启动）：合同签订后第1周-第2周
2. 项目确认：合同签订后第2周-第3周
3. 系统建立：合同签订后第3周-第28周
4. 系统培训：合同签订后第28周-第36周
5. 系统指标调整：合同签订后第40周
6. 质保期：系统验收合格后12个月

### 5.4 项目沟通计划

1. 例行项目会议：每周一次
2. 里程碑评审会议：每个阶段结束时
3. 技术专题会议：根据需要安排
4. 日常沟通机制：电子邮件、即时通讯工具

## 六、风险管理

### 6.1 风险识别

1. 需求不明确导致开发偏离目标
2. 外部系统接口变更影响集成
3. 数据质量问题影响系统使用效果
4. 技术复杂性超出预期
5. 人员变动影响项目进度

### 6.2 风险应对策略

针对每项风险制定具体应对措施，包括预防措施和应急方案。

## 七、质量管理

### 7.1 质量目标

1. 系统功能完整性：覆盖合同约定功能（明确且完整的功能，不包括细节确实、模糊的功能点，参考 “第十点”）
2. 系统稳定性：连续运行720小时，故障率低于1%
3. 系统响应性：90%操作响应时间不超过3秒

### 7.2 质量保证措施

1. 需求确认与评审
2. 设计文档审核
3. 代码规范与审查
4. 单元测试与集成测试
5. 性能测试与安全测试
6. 用户验收测试

## 八、培训计划

### 8.1 培训对象

1. 系统管理员
2. 部门管理员
3. 一般用户

### 8.2 培训内容

1. 系统功能与操作
2. 事故管理流程
3. 指标管理与配置
4. 报表生成与分析
5. 系统维护与管理

### 8.3 培训方式

1. 现场集中培训
2. 操作手册与视频教程
3. 线上答疑与支持

## 九、交付与验收

### 9.1 交付物清单

1. 系统源代码及安装程序
2. 技术文档（架构设计、数据库设计、接口规范）
3. 用户手册与培训资料
4. 测试报告与上线方案
5. 实施总结报告

### 9.2 验收标准

按照合同附件1第四部分"实施内容验收标准"执行，分别从系统功能、数据管理、系统性能、系统安全、系统兼容性等方面进行验收。

## 十、需甲方明确的关键问题

根据"待明确的点.md"文档，我们需要甲方在项目启动阶段明确以下关键问题：

### 10.1 实施依据方面

1. 提供现有指标体系的完整文档、计算公式和定义
2. 提供HR系统接口的详细文档
3. 明确一期项目已建设指标的详细情况
4. 提供现有信息化平台的技术架构与接口文档

### 10.2 技术实现方面

1. 确认系统部署环境（服务器配置、网络环境）
2. 确认是否可采用Docker容器部署
3. 明确数据安全和加密要求
4. 确认浏览器兼容性要求和移动端适配需求

### 10.3 功能需求方面

1. 提供完整的角色-权限矩阵
2. 明确报表自定义和导出的具体需求
3. 确定"系统灵活配置"的具体范围和权限
4. 明确事故管理流程的各环节表单内容和审批规则

### 10.4 集成需求方面

1. 提供"外挂源模型计算工具"的技术规格和接口文档
2. 确认"信息通知功能"的具体需求（通知媒介、触发条件）
3. 明确与其他业务系统的集成需求和方式

### 10.5 数据库设计确认要点

1. 确认CCPS指标体系的详细分类结构
2. 确认事故分类和分级标准
3. 确认各类数据的保留策略和归档要求
4. 确认敏感数据字段及其处理要求
5. 确认报表和统计分析的具体维度要求

## 十一、后续工作计划

1. 与甲方召开需求澄清会议，解决"待明确的点"
2. 完成系统详细设计，包括数据库设计、接口设计等
3. 进行开发环境搭建和技术预研
4. 按照合同进度计划，开展正式开发工作

---

南京工业大学  
项目负责人：张彬  
日期：2025年3月25日
